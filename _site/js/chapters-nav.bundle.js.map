{
  "version": 3,
  "sources": ["../../src/js/chapters-nav.js"],
  "sourcesContent": ["/**\n * Chapter Navigation System for Swiss Design\n * Handles scroll-spy, progress tracking, chapter navigation, and keyboard controls\n */\n\nclass ChaptersNavigation {\n  constructor() {\n    this.chapters = [];\n    this.currentChapter = 0;\n    this.chapterGroups = [\n      { title: \"Introduction\", start: 0, end: 2 },\n      { title: \"The Build Process\", start: 3, end: 8 },\n      { title: \"Technical Deep Dive\", start: 9, end: 12 },\n      { title: \"Lessons & Conclusion\", start: 13, end: 15 },\n    ];\n    this.init();\n  }\n\n  init() {\n    this.findChapters();\n    this.buildNavigation();\n    this.setupScrollSpy();\n    this.setupNavButtons();\n    this.setupKeyboardNav();\n    this.setupMobileToggle();\n  }\n\n  /**\n   * Find all H2 headings with IDs (chapters)\n   */\n  findChapters() {\n    const contentArea = document.querySelector(\".chapters-content .prose-swiss\");\n    if (!contentArea) {\n      return;\n    }\n\n    const headings = contentArea.querySelectorAll(\"h2[id]\");\n    this.chapters = Array.from(headings).map((heading, index) => ({\n      id: heading.id,\n      title: heading.textContent.trim(),\n      element: heading,\n      number: index + 1,\n    }));\n  }\n\n  /**\n   * Build the navigation list with groups and reading times\n   */\n  buildNavigation() {\n    const navList = document.getElementById(\"chapters-list\");\n    if (!navList || this.chapters.length === 0) {\n      return;\n    }\n\n    let html = \"\";\n    let currentGroupIndex = 0;\n\n    this.chapters.forEach((chapter, index) => {\n      // Check if we need to add a group title\n      const group = this.chapterGroups.find((g) => index >= g.start && index <= g.end);\n      if (group && index === group.start && (currentGroupIndex === 0 || index !== 0)) {\n        html += `<li class=\"chapters-section-title\">${group.title}</li>`;\n        currentGroupIndex++;\n      }\n\n      // Calculate reading time (rough estimate: 200 words per minute)\n      const readingTime = this.estimateReadingTime(chapter.element);\n\n      html += `\n      <li>\n        <a href=\"#${chapter.id}\" data-chapter=\"${chapter.number}\">\n          <span class=\"chapter-number\">${chapter.number}</span>\n          <span class=\"chapter-title\">${chapter.title}</span>\n          <span class=\"chapter-time\">${readingTime}</span>\n        </a>\n      </li>\n    `;\n    });\n\n    navList.innerHTML = html;\n\n    // Smooth scroll on click\n    navList.querySelectorAll(\"a\").forEach((link) => {\n      link.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        const targetId = link.getAttribute(\"href\").slice(1);\n        const targetElement = document.getElementById(targetId);\n        if (targetElement) {\n          targetElement.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n          history.pushState(null, null, `#${targetId}`);\n        }\n      });\n    });\n  }\n\n  /**\n   * Estimate reading time for a chapter section\n   */\n  estimateReadingTime(element) {\n    // Find the next h2 or end of content\n    let content = \"\";\n    let currentElement = element.nextElementSibling;\n\n    while (currentElement && currentElement.tagName !== \"H2\") {\n      content += currentElement.textContent || \"\";\n      currentElement = currentElement.nextElementSibling;\n    }\n\n    const wordCount = content.trim().split(/\\s+/).length;\n    const minutes = Math.ceil(wordCount / 200);\n\n    return `${minutes}m`;\n  }\n\n  /**\n   * Setup scroll spy to track current chapter\n   */\n  setupScrollSpy() {\n    if (this.chapters.length === 0) {\n      return;\n    }\n\n    const observerOptions = {\n      root: null,\n      rootMargin: \"-100px 0px -50% 0px\",\n      threshold: 0,\n    };\n\n    const observer = new IntersectionObserver((entries) => {\n      entries.forEach((entry) => {\n        if (entry.isIntersecting) {\n          const chapterIndex = this.chapters.findIndex((ch) => ch.element === entry.target);\n          if (chapterIndex !== -1) {\n            this.setActiveChapter(chapterIndex);\n          }\n        }\n      });\n    }, observerOptions);\n\n    this.chapters.forEach((chapter) => {\n      observer.observe(chapter.element);\n    });\n\n    // Also track scroll progress\n    window.addEventListener(\"scroll\", () => this.updateProgress(), {\n      passive: true,\n    });\n\n    // Initial state\n    this.updateProgress();\n  }\n\n  /**\n   * Set the active chapter in navigation\n   */\n  setActiveChapter(index) {\n    this.currentChapter = index;\n\n    // Update navigation active state\n    const navLinks = document.querySelectorAll(\"#chapters-list a\");\n    navLinks.forEach((link, i) => {\n      if (i === index) {\n        link.classList.add(\"active\");\n      } else {\n        link.classList.remove(\"active\");\n      }\n    });\n\n    // Update prev/next buttons\n    this.updateNavButtons();\n  }\n\n  /**\n   * Update scroll progress indicator and visual bar\n   */\n  updateProgress() {\n    const progressEl = document.getElementById(\"chapters-progress\");\n    const progressFill = document.getElementById(\"chapters-progress-fill\");\n    if (!progressEl) {\n      return;\n    }\n\n    const windowHeight = window.innerHeight;\n    const documentHeight = document.documentElement.scrollHeight;\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n    const scrollPercent = Math.min(\n      100,\n      Math.round((scrollTop / (documentHeight - windowHeight)) * 100)\n    );\n\n    progressEl.textContent = `${scrollPercent}%`;\n\n    if (progressFill) {\n      progressFill.style.width = `${scrollPercent}%`;\n    }\n  }\n\n  /**\n   * Setup previous/next chapter buttons\n   */\n  setupNavButtons() {\n    const prevBtn = document.getElementById(\"prev-chapter\");\n    const nextBtn = document.getElementById(\"next-chapter\");\n\n    if (!prevBtn || !nextBtn) {\n      return;\n    }\n\n    prevBtn.addEventListener(\"click\", () => {\n      if (this.currentChapter > 0) {\n        const prevChapter = this.chapters[this.currentChapter - 1];\n        prevChapter.element.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n        history.pushState(null, null, `#${prevChapter.id}`);\n      }\n    });\n\n    nextBtn.addEventListener(\"click\", () => {\n      if (this.currentChapter < this.chapters.length - 1) {\n        const nextChapter = this.chapters[this.currentChapter + 1];\n        nextChapter.element.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n        history.pushState(null, null, `#${nextChapter.id}`);\n      }\n    });\n\n    this.updateNavButtons();\n  }\n\n  /**\n   * Update prev/next button states\n   */\n  updateNavButtons() {\n    const prevBtn = document.getElementById(\"prev-chapter\");\n    const nextBtn = document.getElementById(\"next-chapter\");\n\n    if (!prevBtn || !nextBtn) {\n      return;\n    }\n\n    prevBtn.disabled = this.currentChapter === 0;\n    nextBtn.disabled = this.currentChapter === this.chapters.length - 1;\n  }\n\n  /**\n   * Setup keyboard navigation (arrow keys)\n   */\n  setupKeyboardNav() {\n    document.addEventListener(\"keydown\", (e) => {\n      // Only handle if not in an input field\n      if (\n        document.activeElement.tagName === \"INPUT\" ||\n        document.activeElement.tagName === \"TEXTAREA\"\n      ) {\n        return;\n      }\n\n      // ArrowUp or 'k' - previous chapter\n      if (e.key === \"ArrowUp\" || e.key === \"k\") {\n        e.preventDefault();\n        if (this.currentChapter > 0) {\n          const prevChapter = this.chapters[this.currentChapter - 1];\n          prevChapter.element.scrollIntoView({\n            behavior: \"smooth\",\n            block: \"start\",\n          });\n          history.pushState(null, null, `#${prevChapter.id}`);\n        }\n      }\n\n      // ArrowDown or 'j' - next chapter\n      if (e.key === \"ArrowDown\" || e.key === \"j\") {\n        e.preventDefault();\n        if (this.currentChapter < this.chapters.length - 1) {\n          const nextChapter = this.chapters[this.currentChapter + 1];\n          nextChapter.element.scrollIntoView({\n            behavior: \"smooth\",\n            block: \"start\",\n          });\n          history.pushState(null, null, `#${nextChapter.id}`);\n        }\n      }\n    });\n  }\n\n  /**\n   * Setup mobile toggle for chapter navigation\n   */\n  setupMobileToggle() {\n    // Create toggle button for mobile\n    const nav = document.getElementById(\"chapters-nav\");\n    if (!nav) {\n      return;\n    }\n\n    // Only create toggle on mobile\n    if (window.innerWidth <= 768) {\n      this.createMobileToggle(nav);\n    }\n\n    // Handle resize\n    window.addEventListener(\"resize\", () => {\n      if (window.innerWidth <= 768) {\n        if (!document.querySelector(\".chapters-toggle\")) {\n          this.createMobileToggle(nav);\n        }\n      } else {\n        const toggle = document.querySelector(\".chapters-toggle\");\n        if (toggle) {\n          toggle.remove();\n        }\n        nav.classList.remove(\"open\");\n      }\n    });\n  }\n\n  /**\n   * Create mobile toggle button\n   */\n  createMobileToggle(nav) {\n    const existingToggle = document.querySelector(\".chapters-toggle\");\n    if (existingToggle) {\n      return;\n    }\n\n    const toggle = document.createElement(\"button\");\n    toggle.className = \"chapters-toggle\";\n    toggle.textContent = \"Chapters\";\n    toggle.setAttribute(\"aria-label\", \"Toggle chapter navigation\");\n\n    toggle.addEventListener(\"click\", () => {\n      nav.classList.toggle(\"open\");\n      toggle.textContent = nav.classList.contains(\"open\") ? \"Close\" : \"Chapters\";\n    });\n\n    document.body.appendChild(toggle);\n\n    // Close on chapter click\n    nav.querySelectorAll(\"a\").forEach((link) => {\n      link.addEventListener(\"click\", () => {\n        nav.classList.remove(\"open\");\n        toggle.textContent = \"Chapters\";\n      });\n    });\n  }\n}\n\n// Initialize when DOM is ready\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    new ChaptersNavigation();\n  });\n} else {\n  new ChaptersNavigation();\n}\n"],
  "mappings": "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",
  "names": ["ChaptersNavigation", "contentArea", "headings", "heading", "index", "navList", "html", "currentGroupIndex", "chapter", "group", "g", "readingTime", "link", "e", "targetId", "targetElement", "element", "content", "currentElement", "wordCount", "observerOptions", "observer", "entries", "entry", "chapterIndex", "ch", "i", "progressEl", "progressFill", "windowHeight", "documentHeight", "scrollTop", "scrollPercent", "prevBtn", "nextBtn", "prevChapter", "nextChapter", "nav", "toggle"]
}
