{
  "version": 3,
  "sources": ["../../src/js/chapters-nav.js"],
  "sourcesContent": ["/**\r\n * Chapter Navigation System for Swiss Design\r\n * Handles scroll-spy, progress tracking, chapter navigation, and keyboard controls\r\n */\r\n\r\nclass ChaptersNavigation {\r\n  constructor() {\r\n    this.chapters = [];\r\n    this.currentChapter = 0;\r\n    this.chapterGroups = [\r\n      { title: \"Introduction\", start: 0, end: 2 },\r\n      { title: \"The Build Process\", start: 3, end: 8 },\r\n      { title: \"Technical Deep Dive\", start: 9, end: 12 },\r\n      { title: \"Lessons & Conclusion\", start: 13, end: 15 },\r\n    ];\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.findChapters();\r\n    this.buildNavigation();\r\n    this.setupScrollSpy();\r\n    this.setupNavButtons();\r\n    this.setupKeyboardNav();\r\n    this.setupMobileToggle();\r\n  }\r\n\r\n  /**\r\n   * Find all H2 headings with IDs (chapters)\r\n   */\r\n  findChapters() {\r\n    const contentArea = document.querySelector(\".chapters-content .prose-swiss\");\r\n    if (!contentArea) {\r\n      return;\r\n    }\r\n\r\n    const headings = contentArea.querySelectorAll(\"h2[id]\");\r\n    this.chapters = Array.from(headings).map((heading, index) => ({\r\n      id: heading.id,\r\n      title: heading.textContent.trim(),\r\n      element: heading,\r\n      number: index + 1,\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Build the navigation list with groups and reading times\r\n   */\r\n  buildNavigation() {\r\n    const navList = document.getElementById(\"chapters-list\");\r\n    if (!navList || this.chapters.length === 0) {\r\n      return;\r\n    }\r\n\r\n    let html = \"\";\r\n    let currentGroupIndex = 0;\r\n\r\n    this.chapters.forEach((chapter, index) => {\r\n      // Check if we need to add a group title\r\n      const group = this.chapterGroups.find((g) => index >= g.start && index <= g.end);\r\n      if (group && index === group.start && (currentGroupIndex === 0 || index !== 0)) {\r\n        html += `<li class=\"chapters-section-title\">${group.title}</li>`;\r\n        currentGroupIndex++;\r\n      }\r\n\r\n      // Calculate reading time (rough estimate: 200 words per minute)\r\n      const readingTime = this.estimateReadingTime(chapter.element);\r\n\r\n      html += `\r\n      <li>\r\n        <a href=\"#${chapter.id}\" data-chapter=\"${chapter.number}\">\r\n          <span class=\"chapter-number\">${chapter.number}</span>\r\n          <span class=\"chapter-title\">${chapter.title}</span>\r\n          <span class=\"chapter-time\">${readingTime}</span>\r\n        </a>\r\n      </li>\r\n    `;\r\n    });\r\n\r\n    navList.innerHTML = html;\r\n\r\n    // Smooth scroll on click\r\n    navList.querySelectorAll(\"a\").forEach((link) => {\r\n      link.addEventListener(\"click\", (e) => {\r\n        e.preventDefault();\r\n        const targetId = link.getAttribute(\"href\").slice(1);\r\n        const targetElement = document.getElementById(targetId);\r\n        if (targetElement) {\r\n          targetElement.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\r\n          history.pushState(null, null, `#${targetId}`);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Estimate reading time for a chapter section\r\n   */\r\n  estimateReadingTime(element) {\r\n    // Find the next h2 or end of content\r\n    let content = \"\";\r\n    let currentElement = element.nextElementSibling;\r\n\r\n    while (currentElement && currentElement.tagName !== \"H2\") {\r\n      content += currentElement.textContent || \"\";\r\n      currentElement = currentElement.nextElementSibling;\r\n    }\r\n\r\n    const wordCount = content.trim().split(/\\s+/).length;\r\n    const minutes = Math.ceil(wordCount / 200);\r\n\r\n    return `${minutes}m`;\r\n  }\r\n\r\n  /**\r\n   * Setup scroll spy to track current chapter\r\n   */\r\n  setupScrollSpy() {\r\n    if (this.chapters.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const observerOptions = {\r\n      root: null,\r\n      rootMargin: \"-100px 0px -50% 0px\",\r\n      threshold: 0,\r\n    };\r\n\r\n    const observer = new IntersectionObserver((entries) => {\r\n      entries.forEach((entry) => {\r\n        if (entry.isIntersecting) {\r\n          const chapterIndex = this.chapters.findIndex((ch) => ch.element === entry.target);\r\n          if (chapterIndex !== -1) {\r\n            this.setActiveChapter(chapterIndex);\r\n          }\r\n        }\r\n      });\r\n    }, observerOptions);\r\n\r\n    this.chapters.forEach((chapter) => {\r\n      observer.observe(chapter.element);\r\n    });\r\n\r\n    // Also track scroll progress\r\n    window.addEventListener(\"scroll\", () => this.updateProgress(), {\r\n      passive: true,\r\n    });\r\n\r\n    // Initial state\r\n    this.updateProgress();\r\n  }\r\n\r\n  /**\r\n   * Set the active chapter in navigation\r\n   */\r\n  setActiveChapter(index) {\r\n    this.currentChapter = index;\r\n\r\n    // Update navigation active state\r\n    const navLinks = document.querySelectorAll(\"#chapters-list a\");\r\n    navLinks.forEach((link, i) => {\r\n      if (i === index) {\r\n        link.classList.add(\"active\");\r\n      } else {\r\n        link.classList.remove(\"active\");\r\n      }\r\n    });\r\n\r\n    // Update prev/next buttons\r\n    this.updateNavButtons();\r\n  }\r\n\r\n  /**\r\n   * Update scroll progress indicator and visual bar\r\n   */\r\n  updateProgress() {\r\n    const progressEl = document.getElementById(\"chapters-progress\");\r\n    const progressFill = document.getElementById(\"chapters-progress-fill\");\r\n    if (!progressEl) {\r\n      return;\r\n    }\r\n\r\n    const windowHeight = window.innerHeight;\r\n    const documentHeight = document.documentElement.scrollHeight;\r\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n\r\n    const scrollPercent = Math.min(\r\n      100,\r\n      Math.round((scrollTop / (documentHeight - windowHeight)) * 100)\r\n    );\r\n\r\n    progressEl.textContent = `${scrollPercent}%`;\r\n\r\n    if (progressFill) {\r\n      progressFill.style.width = `${scrollPercent}%`;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Setup previous/next chapter buttons\r\n   */\r\n  setupNavButtons() {\r\n    const prevBtn = document.getElementById(\"prev-chapter\");\r\n    const nextBtn = document.getElementById(\"next-chapter\");\r\n\r\n    if (!prevBtn || !nextBtn) {\r\n      return;\r\n    }\r\n\r\n    prevBtn.addEventListener(\"click\", () => {\r\n      if (this.currentChapter > 0) {\r\n        const prevChapter = this.chapters[this.currentChapter - 1];\r\n        prevChapter.element.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\r\n        history.pushState(null, null, `#${prevChapter.id}`);\r\n      }\r\n    });\r\n\r\n    nextBtn.addEventListener(\"click\", () => {\r\n      if (this.currentChapter < this.chapters.length - 1) {\r\n        const nextChapter = this.chapters[this.currentChapter + 1];\r\n        nextChapter.element.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\r\n        history.pushState(null, null, `#${nextChapter.id}`);\r\n      }\r\n    });\r\n\r\n    this.updateNavButtons();\r\n  }\r\n\r\n  /**\r\n   * Update prev/next button states\r\n   */\r\n  updateNavButtons() {\r\n    const prevBtn = document.getElementById(\"prev-chapter\");\r\n    const nextBtn = document.getElementById(\"next-chapter\");\r\n\r\n    if (!prevBtn || !nextBtn) {\r\n      return;\r\n    }\r\n\r\n    prevBtn.disabled = this.currentChapter === 0;\r\n    nextBtn.disabled = this.currentChapter === this.chapters.length - 1;\r\n  }\r\n\r\n  /**\r\n   * Setup keyboard navigation (arrow keys)\r\n   */\r\n  setupKeyboardNav() {\r\n    document.addEventListener(\"keydown\", (e) => {\r\n      // Only handle if not in an input field\r\n      if (\r\n        document.activeElement.tagName === \"INPUT\" ||\r\n        document.activeElement.tagName === \"TEXTAREA\"\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      // ArrowUp or 'k' - previous chapter\r\n      if (e.key === \"ArrowUp\" || e.key === \"k\") {\r\n        e.preventDefault();\r\n        if (this.currentChapter > 0) {\r\n          const prevChapter = this.chapters[this.currentChapter - 1];\r\n          prevChapter.element.scrollIntoView({\r\n            behavior: \"smooth\",\r\n            block: \"start\",\r\n          });\r\n          history.pushState(null, null, `#${prevChapter.id}`);\r\n        }\r\n      }\r\n\r\n      // ArrowDown or 'j' - next chapter\r\n      if (e.key === \"ArrowDown\" || e.key === \"j\") {\r\n        e.preventDefault();\r\n        if (this.currentChapter < this.chapters.length - 1) {\r\n          const nextChapter = this.chapters[this.currentChapter + 1];\r\n          nextChapter.element.scrollIntoView({\r\n            behavior: \"smooth\",\r\n            block: \"start\",\r\n          });\r\n          history.pushState(null, null, `#${nextChapter.id}`);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Setup mobile toggle for chapter navigation\r\n   */\r\n  setupMobileToggle() {\r\n    // Create toggle button for mobile\r\n    const nav = document.getElementById(\"chapters-nav\");\r\n    if (!nav) {\r\n      return;\r\n    }\r\n\r\n    // Only create toggle on mobile\r\n    if (window.innerWidth <= 768) {\r\n      this.createMobileToggle(nav);\r\n    }\r\n\r\n    // Handle resize\r\n    window.addEventListener(\"resize\", () => {\r\n      if (window.innerWidth <= 768) {\r\n        if (!document.querySelector(\".chapters-toggle\")) {\r\n          this.createMobileToggle(nav);\r\n        }\r\n      } else {\r\n        const toggle = document.querySelector(\".chapters-toggle\");\r\n        if (toggle) {\r\n          toggle.remove();\r\n        }\r\n        nav.classList.remove(\"open\");\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create mobile toggle button\r\n   */\r\n  createMobileToggle(nav) {\r\n    const existingToggle = document.querySelector(\".chapters-toggle\");\r\n    if (existingToggle) {\r\n      return;\r\n    }\r\n\r\n    const toggle = document.createElement(\"button\");\r\n    toggle.className = \"chapters-toggle\";\r\n    toggle.textContent = \"Chapters\";\r\n    toggle.setAttribute(\"aria-label\", \"Toggle chapter navigation\");\r\n\r\n    toggle.addEventListener(\"click\", () => {\r\n      nav.classList.toggle(\"open\");\r\n      toggle.textContent = nav.classList.contains(\"open\") ? \"Close\" : \"Chapters\";\r\n    });\r\n\r\n    document.body.appendChild(toggle);\r\n\r\n    // Close on chapter click\r\n    nav.querySelectorAll(\"a\").forEach((link) => {\r\n      link.addEventListener(\"click\", () => {\r\n        nav.classList.remove(\"open\");\r\n        toggle.textContent = \"Chapters\";\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\n// Initialize when DOM is ready\r\nif (document.readyState === \"loading\") {\r\n  document.addEventListener(\"DOMContentLoaded\", () => {\r\n    new ChaptersNavigation();\r\n  });\r\n} else {\r\n  new ChaptersNavigation();\r\n}\r\n"],
  "mappings": "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",
  "names": ["ChaptersNavigation", "contentArea", "headings", "heading", "index", "navList", "html", "currentGroupIndex", "chapter", "group", "g", "readingTime", "link", "e", "targetId", "targetElement", "element", "content", "currentElement", "wordCount", "observerOptions", "observer", "entries", "entry", "chapterIndex", "ch", "i", "progressEl", "progressFill", "windowHeight", "documentHeight", "scrollTop", "scrollPercent", "prevBtn", "nextBtn", "prevChapter", "nextChapter", "nav", "toggle"]
}
