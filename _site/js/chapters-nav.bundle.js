(()=>{var l=class{constructor(){this.chapters=[],this.currentChapter=0,this.chapterGroups=[{title:"Introduction",start:0,end:2},{title:"The Build Process",start:3,end:8},{title:"Technical Deep Dive",start:9,end:12},{title:"Lessons & Conclusion",start:13,end:15}],this.init()}init(){this.findChapters(),this.buildNavigation(),this.setupScrollSpy(),this.setupNavButtons(),this.setupKeyboardNav(),this.setupMobileToggle()}findChapters(){let t=document.querySelector(".chapters-content .prose-swiss");if(!t)return;let n=t.querySelectorAll("h2[id]");this.chapters=Array.from(n).map((e,s)=>({id:e.id,title:e.textContent.trim(),element:e,number:s+1}))}buildNavigation(){let t=document.getElementById("chapters-list");if(!t||this.chapters.length===0)return;let n="",e=0;this.chapters.forEach((s,r)=>{let i=this.chapterGroups.find(a=>r>=a.start&&r<=a.end);i&&r===i.start&&(e===0||r!==0)&&(n+=`<li class="chapters-section-title">${i.title}</li>`,e++);let o=this.estimateReadingTime(s.element);n+=`
      <li>
        <a href="#${s.id}" data-chapter="${s.number}">
          <span class="chapter-number">${s.number}</span>
          <span class="chapter-title">${s.title}</span>
          <span class="chapter-time">${o}</span>
        </a>
      </li>
    `}),t.innerHTML=n,t.querySelectorAll("a").forEach(s=>{s.addEventListener("click",r=>{r.preventDefault();let i=s.getAttribute("href").slice(1),o=document.getElementById(i);o&&(o.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,null,`#${i}`))})})}estimateReadingTime(t){let n="",e=t.nextElementSibling;for(;e&&e.tagName!=="H2";)n+=e.textContent||"",e=e.nextElementSibling;let s=n.trim().split(/\s+/).length;return`${Math.ceil(s/200)}m`}setupScrollSpy(){if(this.chapters.length===0)return;let t={root:null,rootMargin:"-100px 0px -50% 0px",threshold:0},n=new IntersectionObserver(e=>{e.forEach(s=>{if(s.isIntersecting){let r=this.chapters.findIndex(i=>i.element===s.target);r!==-1&&this.setActiveChapter(r)}})},t);this.chapters.forEach(e=>{n.observe(e.element)}),window.addEventListener("scroll",()=>this.updateProgress(),{passive:!0}),this.updateProgress()}setActiveChapter(t){this.currentChapter=t,document.querySelectorAll("#chapters-list a").forEach((e,s)=>{s===t?e.classList.add("active"):e.classList.remove("active")}),this.updateNavButtons()}updateProgress(){let t=document.getElementById("chapters-progress"),n=document.getElementById("chapters-progress-fill");if(!t)return;let e=window.innerHeight,s=document.documentElement.scrollHeight,r=window.pageYOffset||document.documentElement.scrollTop,i=Math.min(100,Math.round(r/(s-e)*100));t.textContent=`${i}%`,n&&(n.style.width=`${i}%`)}setupNavButtons(){let t=document.getElementById("prev-chapter"),n=document.getElementById("next-chapter");!t||!n||(t.addEventListener("click",()=>{if(this.currentChapter>0){let e=this.chapters[this.currentChapter-1];e.element.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,null,`#${e.id}`)}}),n.addEventListener("click",()=>{if(this.currentChapter<this.chapters.length-1){let e=this.chapters[this.currentChapter+1];e.element.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,null,`#${e.id}`)}}),this.updateNavButtons())}updateNavButtons(){let t=document.getElementById("prev-chapter"),n=document.getElementById("next-chapter");!t||!n||(t.disabled=this.currentChapter===0,n.disabled=this.currentChapter===this.chapters.length-1)}setupKeyboardNav(){document.addEventListener("keydown",t=>{if(!(document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA")){if((t.key==="ArrowUp"||t.key==="k")&&(t.preventDefault(),this.currentChapter>0)){let n=this.chapters[this.currentChapter-1];n.element.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,null,`#${n.id}`)}if((t.key==="ArrowDown"||t.key==="j")&&(t.preventDefault(),this.currentChapter<this.chapters.length-1)){let n=this.chapters[this.currentChapter+1];n.element.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,null,`#${n.id}`)}}})}setupMobileToggle(){let t=document.getElementById("chapters-nav");t&&(window.innerWidth<=768&&this.createMobileToggle(t),window.addEventListener("resize",()=>{if(window.innerWidth<=768)document.querySelector(".chapters-toggle")||this.createMobileToggle(t);else{let n=document.querySelector(".chapters-toggle");n&&n.remove(),t.classList.remove("open")}}))}createMobileToggle(t){if(document.querySelector(".chapters-toggle"))return;let e=document.createElement("button");e.className="chapters-toggle",e.textContent="Chapters",e.setAttribute("aria-label","Toggle chapter navigation"),e.addEventListener("click",()=>{t.classList.toggle("open"),e.textContent=t.classList.contains("open")?"Close":"Chapters"}),document.body.appendChild(e),t.querySelectorAll("a").forEach(s=>{s.addEventListener("click",()=>{t.classList.remove("open"),e.textContent="Chapters"})})}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new l}):new l;})();
//# sourceMappingURL=chapters-nav.bundle.js.map
